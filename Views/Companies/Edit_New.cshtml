@model License_Tracking.Models.Company

@{
    ViewData["Title"] = $"Edit {Model.CompanyName} - CBMS B2B2B CRM";
}

<div class="container-fluid">
    <!-- Header Section -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h2 class="text-primary mb-1">
                        <i class="fas fa-edit"></i> Edit Company
                    </h2>
                    <p class="text-muted mb-0">Update company profile and business details</p>
                </div>
                <div>
                    <a asp-action="Details" asp-route-id="@Model.CompanyId" class="btn btn-outline-info me-2">
                        <i class="fas fa-eye me-2"></i>View Profile
                    </a>
                    <a asp-action="Index" class="btn btn-outline-secondary">
                        <i class="fas fa-arrow-left me-2"></i>Back to Companies
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Company Form -->
    <div class="row">
        <div class="col-lg-10 mx-auto">
            <div class="card border-0 shadow-sm">
                <div class="card-body p-4">
                    <form asp-action="Edit" method="post" class="needs-validation" novalidate>
                        <div asp-validation-summary="ModelOnly" class="alert alert-danger" role="alert"></div>

                        <input type="hidden" asp-for="CompanyId" />
                        <input type="hidden" asp-for="CreatedDate" />
                        <input type="hidden" asp-for="CreatedBy" />

                        <!-- Company Information Section -->
                        <div class="form-section mb-4">
                            <h5 class="form-section-title">
                                <i class="fas fa-building text-primary me-2"></i>Company Information
                            </h5>
                            <div class="form-section-content">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label asp-for="CompanyName" class="form-label required">Company Name</label>
                                        <input asp-for="CompanyName" class="form-control"
                                            placeholder="Enter company name" required />
                                        <span asp-validation-for="CompanyName" class="text-danger"></span>
                                    </div>
                                    <div class="col-md-6">
                                        <label asp-for="CompanyType" class="form-label required">Company Type</label>
                                        <select asp-for="CompanyType" class="form-select" required>
                                            <option value="">Select Type</option>
                                            <option value="Customer">Customer</option>
                                            <option value="Prospect">Prospect</option>
                                            <option value="Partner">Partner</option>
                                        </select>
                                        <span asp-validation-for="CompanyType" class="text-danger"></span>
                                    </div>
                                    <div class="col-md-6">
                                        <label asp-for="Industry" class="form-label">Industry</label>
                                        <select asp-for="Industry" class="form-select">
                                            <option value="">Select Industry</option>
                                            <option value="Technology">Technology</option>
                                            <option value="Manufacturing">Manufacturing</option>
                                            <option value="Healthcare">Healthcare</option>
                                            <option value="Finance">Finance</option>
                                            <option value="Education">Education</option>
                                            <option value="Retail">Retail</option>
                                            <option value="Government">Government</option>
                                            <option value="Consulting">Consulting</option>
                                            <option value="Real Estate">Real Estate</option>
                                            <option value="Other">Other</option>
                                        </select>
                                        <span asp-validation-for="Industry" class="text-danger"></span>
                                    </div>
                                    <div class="col-md-6">
                                        <label asp-for="CompanySize" class="form-label">Company Size</label>
                                        <select asp-for="CompanySize" class="form-select">
                                            <option value="">Select Size</option>
                                            <option value="1-10">1-10 employees</option>
                                            <option value="11-50">11-50 employees</option>
                                            <option value="51-200">51-200 employees</option>
                                            <option value="201-1000">201-1000 employees</option>
                                            <option value="1000+">1000+ employees</option>
                                        </select>
                                        <span asp-validation-for="CompanySize" class="text-danger"></span>
                                    </div>
                                    <div class="col-md-6">
                                        <label asp-for="AnnualRevenue" class="form-label">Annual Revenue (USD)</label>
                                        <div class="input-group">
                                            <span class="input-group-text">$</span>
                                            <input asp-for="AnnualRevenue" class="form-control" placeholder="0.00"
                                                type="number" step="0.01" />
                                        </div>
                                        <span asp-validation-for="AnnualRevenue" class="text-danger"></span>
                                    </div>
                                    <div class="col-md-6">
                                        <label asp-for="PaymentTerms" class="form-label">Payment Terms</label>
                                        <select asp-for="PaymentTerms" class="form-select">
                                            <option value="">Select Payment Terms</option>
                                            <option value="Net 15">Net 15</option>
                                            <option value="Net 30">Net 30</option>
                                            <option value="Net 45">Net 45</option>
                                            <option value="Net 60">Net 60</option>
                                            <option value="Immediate">Immediate</option>
                                            <option value="Custom">Custom</option>
                                        </select>
                                        <span asp-validation-for="PaymentTerms" class="text-danger"></span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Contact Information Section -->
                        <div class="form-section mb-4">
                            <h5 class="form-section-title">
                                <i class="fas fa-phone text-primary me-2"></i>Contact Information
                            </h5>
                            <div class="form-section-content">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label asp-for="Email" class="form-label">Email Address</label>
                                        <div class="input-group">
                                            <span class="input-group-text">
                                                <i class="fas fa-envelope"></i>
                                            </span>
                                            <input asp-for="Email" class="form-control" type="email"
                                                placeholder="company@domain.com" />
                                        </div>
                                        <span asp-validation-for="Email" class="text-danger"></span>
                                    </div>
                                    <div class="col-md-6">
                                        <label asp-for="ContactNumber" class="form-label">Contact Number</label>
                                        <div class="input-group">
                                            <span class="input-group-text">
                                                <i class="fas fa-phone"></i>
                                            </span>
                                            <input asp-for="ContactNumber" class="form-control"
                                                placeholder="+1 (555) 123-4567" />
                                        </div>
                                        <span asp-validation-for="ContactNumber" class="text-danger"></span>
                                    </div>
                                    <div class="col-md-6">
                                        <label asp-for="Website" class="form-label">Website</label>
                                        <div class="input-group">
                                            <span class="input-group-text">
                                                <i class="fas fa-globe"></i>
                                            </span>
                                            <input asp-for="Website" class="form-control"
                                                placeholder="https://www.company.com" />
                                        </div>
                                        <span asp-validation-for="Website" class="text-danger"></span>
                                    </div>
                                    <div class="col-md-6">
                                        <label asp-for="Headquarters" class="form-label">Headquarters</label>
                                        <input asp-for="Headquarters" class="form-control"
                                            placeholder="City, State, Country" />
                                        <span asp-validation-for="Headquarters" class="text-danger"></span>
                                    </div>
                                    <div class="col-12">
                                        <label asp-for="Address" class="form-label">Address</label>
                                        <textarea asp-for="Address" class="form-control" rows="3"
                                            placeholder="Complete business address"></textarea>
                                        <span asp-validation-for="Address" class="text-danger"></span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Business Details Section -->
                        <div class="form-section mb-4">
                            <h5 class="form-section-title">
                                <i class="fas fa-briefcase text-primary me-2"></i>Business Details
                            </h5>
                            <div class="form-section-content">
                                <div class="row g-3">
                                    <div class="col-12">
                                        <label asp-for="PrimaryBusiness" class="form-label">Primary Business</label>
                                        <textarea asp-for="PrimaryBusiness" class="form-control" rows="2"
                                            placeholder="Describe the company's primary business activities"></textarea>
                                        <span asp-validation-for="PrimaryBusiness" class="text-danger"></span>
                                    </div>
                                    <div class="col-md-6">
                                        <label asp-for="TechnologyStack" class="form-label">Technology Stack</label>
                                        <textarea asp-for="TechnologyStack" class="form-control" rows="3"
                                            placeholder="Technologies, platforms, and tools currently used"></textarea>
                                        <span asp-validation-for="TechnologyStack" class="text-danger"></span>
                                    </div>
                                    <div class="col-md-6">
                                        <label asp-for="CurrentVendors" class="form-label">Current Vendors</label>
                                        <textarea asp-for="CurrentVendors" class="form-control" rows="3"
                                            placeholder="List existing vendor relationships"></textarea>
                                        <span asp-validation-for="CurrentVendors" class="text-danger"></span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Form Actions -->
                        <div class="form-actions">
                            <div class="d-flex justify-content-between">
                                <a asp-action="Index" class="btn btn-light">
                                    <i class="fas fa-times me-2"></i>Cancel
                                </a>
                                <div>
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-save me-2"></i>Update Company
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }

    <script>
        // Form validation
        (function () {
            'use strict';
            window.addEventListener('load', function () {
                var forms = document.getElementsByClassName('needs-validation');
                var validation = Array.prototype.filter.call(forms, function (form) {
                    form.addEventListener('submit', function (event) {
                        if (form.checkValidity() === false) {
                            event.preventDefault();
                            event.stopPropagation();
                        }
                        form.classList.add('was-validated');
                    }, false);
                });
            }, false);
        })();

        // Auto-format website URL
        document.querySelector('input[name="Website"]').addEventListener('blur', function () {
            let value = this.value.trim();
            if (value && !value.startsWith('http://') && !value.startsWith('https://')) {
                this.value = 'https://' + value;
            }
        });

        // Character counters for text areas
        document.querySelectorAll('textarea').forEach(textarea => {
            textarea.addEventListener('input', function () {
                const maxLength = this.getAttribute('maxlength');
                if (maxLength) {
                    const currentLength = this.value.length;
                    // Add character counter logic here if needed
                }
            });
        });
    </script>
}
